<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=1024, user-scalable=no">

  <title>The Lazy Dev's Guide to Testing Your Web API</title>

  <link rel="stylesheet" href="./resources/deck-js/core/deck.core.css">
  <link rel="stylesheet" href="./resources/deck-js/extensions/hash/deck.hash.css">
  <link rel="stylesheet" href="./resources/deck-js/themes/style/rfkelly.css">

  <link rel="stylesheet" href="./resources/playitagainsam-js/playitagainsam.css">

  <style type="text/css">
  body .pias-container {
    margin: 1em;
  }
  </style>

  <script src="./resources/deck-js/modernizr.custom.js"></script>
  <script src="./resources/deck-js/jquery-1.7.2.min.js"></script>
  <script src="./resources/flot/jquery.flot.js"></script>
  <script src="./resources/flot/jquery.flot.axislabels.js"></script>
  <script src="./resources/deck-js/core/deck.core.js"></script>
  <script src="./resources/deck-js/extensions/hash/deck.hash.js"></script>
  <script src="./resources/playitagainsam-js/playitagainsam.js"></script>

  <script type="text/javascript">
  $(function() {
      $.deck('.slide');
  });

  var onEnterSlideCallbacks = {}
  var onEnterSlide = function(selector, cb) {
      var slide_id = $(selector).attr("id");
      if(typeof onEnterSlideCallbacks[slide_id] == "undefined") {
          onEnterSlideCallbacks[slide_id] = [];
      }
      onEnterSlideCallbacks[slide_id].push(cb)
  }
  $(document).bind("deck.change", function(event, from, to) {
      var slide_id = $.deck("getSlide", to).attr("id");
      var callbacks = onEnterSlideCallbacks[slide_id];
      if(typeof callbacks != "undefined") {
          for(var i=0; i<callbacks.length; i++) {
              callbacks[i]();
          }
      }
  });

  var writePIASSlide = function(id) {
      document.write('<section class="slide" id="pias-' + id + '-slide">');
      document.write('<div id="pias-' + id + '-player"></div>');
      document.write('<scr' + 'ipt type="text/javascript" src="./resources/pias-' + id + '.js"></scr' + 'ipt>');
      document.write('<scr' + 'ipt type="text/javascript">');
      $(function() {
          onEnterSlide("#pias-" + id + "-slide", function() {
              var player = new PIAS.Player($("#pias-" + id + "-player"))
              var varname = "pias_" + id + "_data";
              while(varname != varname.replace("-", "_")) {
                  varname = varname.replace("-", "_");
              }
              player.play(window[varname], function() {
                  player.destroy();
              });
          });
      });
      document.write('</scr' + 'ipt>');
      document.write('</section>');
  }
  </script>

</head>
<body class="deck-container">

<section class="slide">
  <h2>The Lazy Dev's Guide to...</h2>  
  <h1>Testing Your Web API</h1>
</section>


<section class="slide">
  <h2>Is this you?</h2>
  <h1>I Love Testing!</h1>
</section>


<section class="slide">
  <h2>Is this you?</h2>
  <h1>I Hate Testing!</h1>
</section>


<section class="slide" id="qa-plot-slide">
  <h2>Quality Assurance</h2>
  <table id="qa-plot-container">
  <tr><td colspan="2" style="text-align:center">&nbsp;</td></tr>
  <tr><td colspan="2" style="text-align:center">&nbsp;</td></tr>
  <tr><td style="vertical-align:middle;">quality&nbsp;</td><td>
    <div id="qa-plot" style="width:800px;height:400px"></div>
  </td></tr><tr><td colspan="2" style="text-align:center">effort</td></tr>
  </table>
  <script type="text/javascript">
  $(function() {

      onEnterSlide("#qa-plot-slide", function() {
          $("#qa-plot-container").position({
              my: "center", at: "center", of: $("#qa-plot-slide")
          });
      });

      var plot = $("#qa-plot")
      var highlights = [];
      var slope = 0.2;
      var func = function(x) {
         return 1 - (1 / Math.exp(slope * x));
      }
      var redraw = function() {
         var series = []
         var data = [];
         for (var i=0; i<30; i=i+0.2) {
            data.push([i, func(i)]);
         }
         series.push(data);
         for(var i=0; i<highlights.length; i++) {
             var x = highlights[i].datapoint[0];
             var y = func(x);
             series.push([[x, 0], [x, y]])
             series.push([[0, y], [x, y]])
         }
         $.plot(plot, series, {
           xaxis: { show: false },
           yaxis: { show: false },
           grid: { hoverable: true, mouseActiveRadius: 10 },
         });
      };
      redraw();
      var is_dragging = false;
      var did_drag = false;
      var click_target = null;
      plot.bind("mousedown", function() {
         is_dragging = true;
         did_drag = false;
      });
      plot.bind("plothover", function(e, pos, item) {
          click_target = item;
          if(is_dragging) {
              did_drag = true;
              slope = Math.log(-1 / (pos.y - 1)) / pos.x
              redraw();
          }
      });
      plot.bind("mouseup", function() {
          is_dragging = false;
          if(!did_drag && click_target) {
             highlights.push(click_target);
             redraw();
          }
          did_drag = false;
      });
  });
  </script>
</section>


<section class="slide">
  <h1>Do More<br/>With Less</h1>
</section>

<section class="slide">
  <h2>Pro-Active Laziness</h2>
  <div class="slide">
  <img src="./resources/images/Moving-pictures-cover.jpg" style="float: left; margin: 2em;" />
  <blockquote>&nbsp;</blockquote>
  <blockquote>"Victor Tugelbend was the laziest person in the history of the world."</blockquote>
  <blockquote>"Not simply, ordinarily lazy.  Ordinary laziness was merely the absence of effort."</blockquote>
  <blockquote>"He put more effort into avoiding work than most people put into hard labour."</blockquote>
  </div>
</section>

<section class="slide">
  <h2>What do I know anyway?</h2>
 <ul>
   <li>Mozilla Services</li>
   <ul><li>Firefox Sync Server</li></ul>
   <li>Going to show the tools we use</li>
   <ul><li>Some of this is stuff we already do</li>
      <li>Some is stuff I want to try out</li></ul>
   <li>I'm an enthusiast, not an expert</li>
 </ul>
</section>


<section class="slide">
  <h1>WebTest</h1>
</section>


<script type="text/javascript">
  writePIASSlide("webtest-demo");
</script>

<section class="slide">
  <h1>WSGIProxy</h1>
</section>


<section class="slide">
  <h2>Like a Reverse WSGI Server</h2>
  <p>WSGI Server:  HTTP Request --&gt; WSGI Call</p>
  <p>WSGIProxy:  WSGI Call --&gt; HTTP Request</p>
</section>


<script type="text/javascript">
  writePIASSlide("wsgiproxy-demo");
</script>


<section class="slide">
  <h2>Is this really that valuable?</h2>
  <ul class="slide">
   <li>Yes</li>
   <ul class="slide">
     <li>Plenty can go wrong during a deployment.</li>
     <li>Plus you're basically getting it for free</li>
   </ul>
  </ul>
</section>

<section class="slide">
  <h1>FunkLoad</h1>
</section>

<section class="slide">
  <h1>Summing Up...</h>
</section>

<section class="slide">
  <h2>It's not about specific tools</h2>
  <p>WebTest --&gt; FunkLoad --&gt; Web Server</p>
  <p>FunkLoad --&gt; WSGI-Intercept --&gt; In-Process WSGI APP</p>
  <p>Find opportunities for re-use!</p>
  <p>Think about your tools</p>
</section>


<section class="slide">
  <h2>Thanks</h2>
  <ul>
   <li>Tarek Ziade</li>
   <li>James Bonacci</li>
  </ul>
</section>


<section class="slide">
  <h2>More Info</h2>
  <p>ryan@rfk.id.au</p>
  <p>https://github.com/rfk/talk-webapitesting</p>

  <p>http://webtest.pythonpaste.org</p>
  <p>http://pythonpaste.org/wsgiproxy</p>
  <p>http://funkload.nuxeo.org/</p>
</section>
</body>
</html>
